<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Title</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
    <script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
</head>
<body>

    <h1>CostMates</h1>
    <nav>
        <div class="nav nav-tabs" id="tabs" role="tablist"></div>
    </nav>

    <button class="button" onclick="newRow()">
        New Row
    </button>

    <!--
    place holder table
    test row and column dragging
    -->
    <table class="table mytable" id="table">
        <thead>
        <tr>
            <td id="corner"></td>
            <th scope="col" class="sortme">Col I</th>
            <th scope="col" class="sortme">Col II</th>
            <th scope="col" class="sortme">Col III</th>
        </tr>
        </thead>
        <tbody>
            <tr class="sortme">
                <th scope="row" class="r">Row I</th>
                <td>Closed</td>
                <td>Open</td>
                <td>Open</td>
            </tr>
            <tr class="sortme">
                <th scope="row" class="r">Row II</th>
                <td>Open</td>
                <td>Closed</td>
                <td>Open</td>
            </tr>
            <tr class="sortme">
                <th scope="row" class="r">Row III</th>
                <td>Open</td>
                <td>Open</td>
                <td>Closed</td>
            </tr>
        </tbody>
    </table>

    <script>
        $(function() {
            function moveColumn(table, sourceIndex, targetIndex) {
                console.log("Move Col " + sourceIndex + " to " + targetIndex);
                var body = $("tbody", table);
                
                $("tr", body).each(function(i, row) {
                    console.log(i);
                    if (sourceIndex < targetIndex){
                        $("td", row).eq(sourceIndex-1).insertAfter($("td", row).eq(targetIndex-1));
                    }
                    else{
                        $("td", row).eq(sourceIndex-1).insertBefore($("td", row).eq(targetIndex-1));
                    }
                });
            }

            $(".mytable > thead > tr").sortable({
                items: "> th.sortme",
                start: function(event, ui) {
                    ui.item.data("source", ui.item.index());
                },
                update: function(event, ui) {
                    moveColumn($(this).closest("table"), ui.item.data("source"), ui.item.index());
                    $(".mytable > tbody").sortable("refresh");
                }
            });

            $(".mytable > tbody").sortable({
                handle: ".r",
                items: "> tr.sortme"
            });
        });

        function newRow() {
            $("#table").find('tbody')
                .append($('<tr>').attr('class','sortme')
                    .append($('<th>').attr('scope', 'row').attr('class','r').text('NewRow'))
                    .append($('<td>').text('closed'))
                    .append($('<td>').text('closed'))
                    .append($('<td>').text('closed'))
                );
        }
    </script>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    <script src="../static/createTabs.js"></script>
</body>
</html>